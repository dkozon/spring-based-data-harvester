package net.kozon.dataanalyzer.service;

import lombok.extern.slf4j.Slf4j;
import org.codehaus.plexus.util.xml.CompactXMLWriter;
import org.codehaus.plexus.util.xml.XmlWriterUtil;

import java.io.IOException;
import java.io.PrintWriter;

@Slf4j
public class DataPresentationServiceExploitable {

    private static final String XML_INJECTION = "--><div><form action='abc' method='get'><!--\n" +
            "--><input type='tekst'>Jakies inne pole'</input><!--\n" +
            "--><input type='text'>abc</input> </form> </div><!--";

    public void presentDataBy() throws IOException {
        PrintWriter printWriter = new PrintWriter("new_file.xml");
        printWriter.println("<?xml version=\"1.0\" encoding=\"utf-8\"?>\n" +
                "<div>\n" +
                "<form action=\"\" method=\"get\">\n" +
                "    <label for=\"login\">Login</label>\n" +
                "    <input type=\"text\" name=\"login\">Login</input>\n" +
                "    <label for=\"password\">Hasło</label>\n" +
                "    <input type=\"text\" name=\"password\">Hasło</input>\n" +
                "    <input type=\"submit\">Wyślij</input>\n" +
                "    </form>\n" +
                "</div>");
        CompactXMLWriter compactXMLWriter = new CompactXMLWriter(printWriter);
        XmlWriterUtil.writeComment(compactXMLWriter, XML_INJECTION, 0, 0); // podatna metoda
        printWriter.close();
    }
}
